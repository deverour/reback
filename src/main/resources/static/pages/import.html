<!DOCTYPE html>
<html>
<head>
    <!-- 页面meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>传智健康</title>
    <meta name="description" content="传智健康">
    <meta name="keywords" content="传智健康">
    <meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport">
    <!-- 引入样式 -->
    <link rel="stylesheet" href="../plugins/elementui/index.css">
    <link rel="stylesheet" href="../plugins/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="../css/style.css">

    <!-- 引入组件库 -->
    <script src="../js/vue.js"></script>
    <script src="../plugins/elementui/index.js"></script>
    <script type="text/javascript" src="../js/jquery.min.js"></script>
    <script src="../js/axios-0.18.0.js"></script>
</head>
<body class="hold-transition">
<div id="app">
    <div class="content-header">
        <h1>导入导出<small>签认明细上传</small></h1>
        <el-breadcrumb separator-class="el-icon-arrow-right" class="breadcrumb">
            <el-breadcrumb-item :to="{ path: '/' }">首页</el-breadcrumb-item>
            <el-breadcrumb-item>导入导出</el-breadcrumb-item>
            <el-breadcrumb-item>签认明细上传</el-breadcrumb-item>
        </el-breadcrumb>
    </div>
    <div class="app-container">
        <div class="box">
				<h3><small>代垫电费签认表上传</small></h3>
                <el-card class="box-card">
                    <div class="boxMain">
                        <el-button style="margin-bottom: 20px;margin-right: 20px" type="primary" @click="downloadTemplate()">模板下载</el-button>
                        <el-upload action="/bill/upload"
                                   name="excelFile"
                                   :show-file-list="false"
                                   :on-success="handleSuccess"
                                   :before-upload="beforeUpload">
                            <el-button type="primary">上传文件</el-button>
                        </el-upload>
                    </div>
                    <div>
                        请以电费签认表表二为数据来源制表，以免后期取数导致电量翻倍（电费签认表表一为系统分摊出账，直供电按票据数量会出两条电量一样的明细），目前三家运营商电费签认表均有新模板（类似电信）
                    </div>
                </el-card>
                
           
        </div>
		<div class="box">
				<h3><small>包干电费签认表上传</small></h3>
		        <el-card class="box-card">
		            <div class="boxMain">
		                <el-button style="margin-bottom: 20px;margin-right: 20px" type="primary" @click="downloadTemplate()">模板下载</el-button>
		                <el-upload action="/cpy/upload.do"
		                           name="excelFile"
		                           :show-file-list="false"
		                           :on-success="handleSuccess"
		                           :before-upload="beforeUpload">
		                    <el-button type="primary">上传文件</el-button>
		                </el-upload>
		            </div>
		            <div>
		                操作说明：请点击"模板下载"按钮获取模板文件，在模板文件中录入预约设置数据后点击"上传文件"按钮上传模板文件。
		            </div>
		        </el-card>
		        
		   
		</div>
    </div>
</div>
</body>
<!-- 引入组件库 -->
<script src="../js/vue.js"></script>
<script src="../plugins/elementui/index.js"></script>
<script type="text/javascript" src="../js/jquery.min.js"></script>
<script>
    new Vue({

        el: '#app',
        data:{
            backend_url:"http://localhost:9002",
            today:new Date(),
            currentDay: 1,
            currentMonth: 1,
            currentYear: 1970,
            currentWeek: 1,
            days: [],  // 封装每一天的日期对象(Date对象)和index，遍历日历使用的数据模型
            leftobj: []//用于装载页面显示的月份已经进行预约设置的数据，从服务端获取的数据
        },
        created: function () {//在vue初始化时调用

        },
        methods: {

            beforeUpload(file){
                console.log(file.name);
                // 使用后缀名，判断文件类型
                var fileName = file.name;
                var fileType = fileName.substr(fileName.lastIndexOf("."));
                console.log("fileType:"+fileType);
                const isXLS = file.type === 'application/vnd.ms-excel';
                if(isXLS){
                    return true;
                }
                const isXLSX = file.type === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet';
                if (isXLSX) {
                    return true;
                }
                this.$message.error('上传文件只能是xls或者xlsx格式!');
                return false;
            },
            downloadTemplate(){
                window.location.href="../../template/ordersetting_template.xlsx";
            },
            handleSuccess(response, file) {
                if(response.flag){
                    this.$message({
                        message: response.message,
                        type: 'success'
                    });
                }else{
                    this.$message.error(response.message);
                }
                console.log(response, file, fileList);
            },



        }
    })
</script>
</html>